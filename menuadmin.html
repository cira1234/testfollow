<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.12/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/lazywasabi/thai-web-fonts@7/fonts/Anakotmai/Anakotmai.css" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <script src="carddata.js"></script> -->
    <script src="domain.js"></script>
    <link href="sidebar.css" rel="stylesheet">
    <title>All Post</title>
    

</head>
<body>
<style>
    .container2{
        /* background-color: aqua; */
        /* margin-left: 23rem; */
        margin-left: 15rem;
    }
    .card{
        width:60%;
    /* margin-top: 5rem; */
    /* margin-left: 10rem; */
    height:500px;
    margin: 50px;
    box-shadow: 5px 5px 10px gray;
    border-radius: 20px;
    overflow: hidden;
}
.img1{
    width: 100%;
        height: 345px;
     
        object-fit: cover;
     }

.check{
  background:#0066ff;
}
.marginbutton{
    margin-top: 20px;
}
.container3{
        /* background-color: aqua; */
        /* margin-left: 23rem; */
       margin-left: 20px;
    }
    .card2::-webkit-scrollbar{
        width: 0;
    }
    .card2{
        width:60%;
    /* margin-top: 5rem; */
    /* margin-left: 10rem; */
    height:500px;
    margin: 50px;
    box-shadow: 5px 5px 10px gray;
    border-radius: 20px;
    overflow: auto;
    }
    .noimg{
    width:100%;
    height: 100px;
    background: white;
}
.noimg3{
    margin-top: 200px;
}
</style>

    
<div class="wrapper">

<div class="sidebar">

    <h3>Dasboard</h3>
    <ul>
        <li><a href="menuadmin.html"  style="text-decoration:none"  class="check" ><i class="fas fa-home"></i>Home</a></li>
        <li><a href="tableuser.html"style="text-decoration:none"><i class="fas fa-user"></i>Regis</a></li>
        <li><a href="tablemember.html" style="text-decoration:none" ><i class="fas fa-address-book"></i>Users</a></li>
        <li><a href="learnadmin.html" style="text-decoration:none"><i class="fas fa-graduation-cap"></i>Learn</a></li>
        <li><a href="insertlearn.html" style="text-decoration:none"  ><i  class="fas fa-graduation-cap"></i>Add+</a></li>
        <li><a href="inserttest.html" style="text-decoration:none" ><i  class="fas fa-chalkboard-teacher"></i>AddQ+</a></li>
        <li><a href="showquiz.html" style="text-decoration:none" ><i  class="fas fa-chalkboard-teacher"></i>Quiz</a></li>
        <li><a href="inserttypevideo.html" style="text-decoration:none"><i  class="fas fa-chalkboard-teacher"></i>typeV+</a></li>
        <li><a href="showquiz.html" style="text-decoration:none"><i  class="fas fa-chalkboard-teacher"></i>typeS</a></li>
        <li><a href="assist.html" style="text-decoration:none"><i  class="fas fa-chalkboard-teacher"></i>Assist</a></li>
        <li><a href="banuser.html" style="text-decoration:none"><i  class="fas fa-ban"></i>Ban</a></li>
        <li><a onclick="logout()" style="text-decoration:none"><i class='fas fa-sign-out-alt'></i>Logout</a></li>

    </ul>

</div>
<div class="main_content">
    <div class="header">Edit or insert your post</div>
<div class="container2"id="allpost">
    <div class="card3" >
        <img src="img/logo.png" class="img1" alt="...">
        <div class="card-body">
          <h5 class="card-title">Not found</h5>
          <p class="card-text">please check post or internet</p>
            
        </div>
        </div>
      </div>

      <div class="container2"id="allpost2">
        <div class="card3" >
            <img src="img/logo.png" class="img1" alt="...">
            <div class="card-body">
              <h5 class="card-title">Not found</h5>
              <p class="card-text">please check post or internet</p>
                
            </div>
            </div>
          </div>

      
       
     






</div>

</div>
         
</div>  
    
    
</body>
</html>
<script>
        const emailvalue=localStorage.getItem('email-send');
       const passvalue=localStorage.getItem('pass-send');
        if(emailvalue==null && passvalue==null){
            window.location.href="./index.html";
        }
        else  if(emailvalue!='Admin69@gmail.com' && passvalue!='090165'){
            window.location.href="./index.html";
        }
       console.log(emailvalue)
        console.log(passvalue)
       function logout(){
        console.log('function logout');
        localStorage.removeItem('email-send')
        localStorage.removeItem('pass-send')
        window.location.href="./index.html";

       }
       var url=localStorage.getItem('send-url')
        var domainweb=localStorage.getItem('send-domain')

     const idglobal=localStorage.getItem('idglobal-send');
    allpost()
    function allpost(){

        
        console.log('id User');
        console.log(idglobal);

const http= new XMLHttpRequest();
http.open("GET",url+"/selectpostreport");
http.send();
http.onreadystatechange=function(){
    if(this.status !="[]"){
        objects = JSON.parse(this.responseText);
        var dataStore ='';
    for(let object of objects){
        idpostsend=object['id_post'];
        localStorage.setItem('idglobalpost-send',idpostsend);
        dataStore +=`
      
    <div class="card2" id="allpost">
        <img width="100%"  height="300px" border-radius="50px" src="${[domainweb]+["imgpost/"]+object["img"]}">
        <div class="card-body">
          <h5 class="card-title">${object["section"]}</h5>
          <p class="card-text">${object["textpost"]}</p>
          <div class="container" align="center">
          <button class="btn btn-primary" onclick="comment(${object['id_post']},${object['id_userpost']})">Comment</button>
          <button class="btn btn-primary" onclick="deletepost(${object['id_post']})">Delete</button>
        
        </div>
        </div>
      </div>

      
       
     






</div>

</div>
         
</div>  
     


`;


    }

}

    document.getElementById("allpost").innerHTML=dataStore;
    checknoimg()

    // document.getElementById("indexdata").innerHTML=dataStore;
}

}

function deletepost(object){
    console.log(object)
    const http= new XMLHttpRequest();
    http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/deletepost/"+object);
    http.send();
    window.location.reload(true);
}


function checknoimg(){
    const http= new XMLHttpRequest();
    http.open("GET",url+"/selectpostreportnoimg");
http.send();
http.onreadystatechange=function(){
    objects = JSON.parse(this.responseText);
        var dataStore3 ='';
        
  
    for(let object of objects){
  
        dataStore3 +=`
    
        <div class="card2" id="allpost2">
        <div class="noimg">
        </div>
        <div class="card-body">
          <h5 class="card-title">${object["section"]}</h5>
          <p class="card-text">${object["textpost"]}</p>
          <div class="container" align="center">
            <div class="noimg3">
        </div>
        <button class="btn btn-primary" onclick="comment(${object['id_post']},${object['id_userpost']})">Comment</button>
          <button class="btn btn-primary" onclick="deletepost(${object['id_post']})">Delete</button>
        </div>
        </div>
      </div>
      
       
     






</div>

</div>
         
</div>  
     
 
      
       
     






</div>

</div>
         
</div>  
     


`;

    }

// }


    document.getElementById("allpost2").innerHTML=dataStore3;
    
    // document.getElementById("indexdata").innerHTML=dataStore;
}

}


function comment(idpost,id2){
    console.log('function  comment');
    console.log(idpost);
    console.log(id2);
//    window.location.reload(true);
//     console.log(object);
//     const section=document.getElementById('section2').value;
//  const question=document.getElementById('question2').value;
//     const http= new XMLHttpRequest();
//     http.open("GET","https://aggressive-tie-jay.cyclic.app/editpost/"+section+"/"+question+"/"+object);
//     http.send();  




    Swal.fire({
  position: 'center',
 
  html:`
      
             
  <input type="submit"     onclick="writecomment(${idpost})" class="btn btn-primary w-100" class="buttonlogin" name="btn-post" value="Write Comment" >
                </div>
  
                <div class="marginbutton">
                    <input type="submit"     onclick="showcomment(${idpost})" class="btn btn-primary w-100" class="buttonlogin" name="btn-post" value="View Comment" >
               
            <!-- </form> -->
           
        
 
        <div id="result"></div>
 </div>

</div>
</div>
        `,
  showConfirmButton: false,
//   timer: 1500
})

 }



 function insertcomment(idpost){


const comment=document.getElementById('comment2').value;
const img=document.getElementById('files').value;
const namefilepost=img.split('\\').pop().split('/').pop();

console.log('function insert comment');
console.log(idpost);

console.log(idglobal);
console.log(comment);
console.log(namefilepost);





              const http= new XMLHttpRequest();
              //  http.open("GET","https://aggressive-tie-jay.cyclic.app/selectuser");
http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/insertcomment/"+comment+"/"+namefilepost+"/"+idglobal+"/"+idpost);
                http.send();
                window.location.reload(true);
}





   function allcomment(idpost){

       console.log("this function showpostall")
    //    console.log(emailvalue);
    //    console.log(passvalue);
       console.log(idpost)
const http= new XMLHttpRequest();
http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/selectcomment/"+idpost);
http.send();
http.onreadystatechange=function(){
   if(this.status !="[]"){
       objects = JSON.parse(this.responseText);
       var dataStore ='';
   for(let object of objects){

       dataStore +=`
       <div class="container3"id="allcomment">
       <div class="card2" style="width: 18rem;">
   <div class="card-body">
       <img  width="20%"  height="50px" border-radius="50px" src="${[domainweb]+["imgpost/"]+object["imguser"]}" class="rounded-circle" alt="...">
     <h5 class="card-title" >${object['name']}</h5>
    
     <div class="margintext">
       
     <p class="card-text">${object['messege']}</p>
     <img  width="100%"  height="150px" border-radius="50px" src="${[domainweb]+["imgpost/"]+object["imgcom"]}" class="border border-3" alt="...">
     <button class="btn btn-primary"  onclick="deletecomment(${object['id_com']})">delete</button>
     </div>
   </div>
 </div>
    
</div>

`;


   }

}

   document.getElementById("allcomment").innerHTML=dataStore;

   // document.getElementById("indexdata").innerHTML=dataStore;
}

}



function showcomment(idpost){
   allcomment(idpost);
   Swal.fire({
 position: 'center',

 html:`
 <div class="container3"id="allcomment">
<div class="card2" style="width: 18rem;" >
   <div class="card-body">
      <div class="profile"></div> 
     <h5 class="card-title" >Card title</h5>
     <div class="margintext">
     <p class="card-text">Some quick example text to build on the card title and make up the bulk of the card's content.</p>
     </div>
   </div>
 </div>
</div>

       
       `,
 showConfirmButton: false,
//   timer: 1500
})

}

// allmenu()


function writecomment(idpost){
    console.log('function insert writecomment');
    console.log(idpost);
//    window.location.reload(true);
//     console.log(object);
//     const section=document.getElementById('section2').value;
//  const question=document.getElementById('question2').value;
//     const http= new XMLHttpRequest();
//     http.open("GET","https://aggressive-tie-jay.cyclic.app/editpost/"+section+"/"+question+"/"+object);
//     http.send();  




    Swal.fire({
  position: 'center',
 
  html:`
      
             
        
  <form  method="post" enctype="multipart/form-data" id="uploadFile">
       
  
    <div class="mb-3">
  <label for="exampleFormControlTextarea1" class="form-label"></label>
  <textarea class="form-control" id="comment2" rows="3"></textarea>
</div>

                <input type="file" name="file"  id="files" multiple><br>
                <input type="submit"     onclick="insertcomment(${idpost})" class="btn btn-primary w-100" class="buttonlogin" name="btn-post" value="Comment" >
               
            <!-- </form> -->
           
        
        </form>
        <div id="result"></div>
 </div>

</div>
</div>


    </div>
        
        
        `,
  showConfirmButton: false,
//   timer: 1500
})

}

function deletecomment(object){
    console.log('function delete comment')
    console.log(object)
    const http= new XMLHttpRequest();
    http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/deletecomment/"+object);
    http.send();  
    window.location.reload(true);
}



function report(object){
    console.log('function reportpost')
    console.log(object)
    const http= new XMLHttpRequest();
    http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/report/"+object);
    http.send();  
    window.location.reload(true);
}



$(document).on('submit','#uploadFile',function(e){
        e.preventDefault();
       var formData = new FormData(this);
        $.ajax({
        method:"POST",
        url: "saveimg2.php",
        data:formData,
        cache:false,
        contentType: false,
        processData: false,
         beforeSend:function(){
         $('button[type="submit"]').attr('disabled','disabled');
       },
        success: function(data){
       
        $('button[type="submit"]').removeAttr('disabled');
       
         $('#alertBox').html(data).fadeIn();
      }
           
});

      });   
</script>