<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.12/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/lazywasabi/thai-web-fonts@7/fonts/Anakotmai/Anakotmai.css" rel="stylesheet" />
    <script src="https://kit.fontawesome.com/b99e675b6e.js"></script>
    <!-- libary ajax -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- <script src="checklogin.js"></script> -->
    <!-- <script src="checklogin.js"></script> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="sidebar.css" rel="stylesheet">
    <link href="card.css" rel="stylesheet">
    <title>Write Post</title>
    

</head>
<body>


    
<div class="wrapper">

<div class="sidebar">

    <h3>Dasboard</h3>
    <ul>
        <li><a href="meprofile.html"  style="text-decoration:none"><i class="fas fa-home"></i>Home</a></li>
        <li><a href="profileset.html" style="text-decoration:none" ><i class="fas fa-user"></i>Profile</a></li>
        <li><a href="showpost.html" style="text-decoration:none" ><i class="fas fa-address-card"></i>Post</a></li>
        <li><a href="learn.html" style="text-decoration:none"><i  class="fas fa-graduation-cap"></i>Learn</a></li>
        <li><a href="write.html" style="text-decoration:none"  class="check"><i class="fas fa-pen"></i>Write</a></li>
        <li><a href="showquizuser.html" style="text-decoration:none"  ><i  class="fas fa-chalkboard-teacher"></i>Quiz</a></li>
        <li><a href="assistuser.html" style="text-decoration:none"  ><i  class="fas fa-chalkboard-teacher"></i>Assist</a></li>
        <li><a onclick="logout()" style="text-decoration:none"><i class='fas fa-sign-out-alt'></i>Logout</a></li>
    </ul>

</div>
<style>
    .dropdown_menu{
       height: 0;
       display: none;
       position: absolute;
       right: 2rem;
       top:60px;
       margin-right: 50px;
       width: 150px;
       background: rgb(30, 240, 250,0.1);
       /* background: rgb(255, 255, 255,0.1); */
       /* background: red; */
       backdrop-filter: blur(15px);
       border-radius: 20px;
       overflow: hidden;
       transition: height 0.2s cubic-bezier(0.175,0.885,0.32,1.275);
    }
    .dropdown_menu.open{
       height: 240px;
   }
   .toggle_btn{
       display: none;
       position: absolute;
       right:30px;
       margin-top: -30px;
   }
   
   </style>

<style>

    .img1{
    width: 300px;
        height: 345px;
     
        object-fit: cover;
     }
 
.card{
    width: 300px;
    margin-top: 5rem;
    height:345px;
    margin: 50px;
    box-shadow: 5px 5px 10px black;
    border-radius: 20px;
    overflow: hidden;
}
.check{
  background:#0066ff;
}
.martop{
    margin-top: 50px;
    margin-left: 30%;
    width: 100%;
 
}
@media(max-width:992px){
    .sidebar{
        display: none;
    }
    .header{
        margin-left: -200px;
    }
    .martop{
        margin-left: -170px;
    }
    .toggle_btn{
    position: absolute;
    right: 20px;
    margin-top: -25px;
    }
    .dropdown_menu{
        right: -50px;
        display: block;
    }
    .toggle_btn{
        display: block;
    }
    .text_dropdown{
        margin-left: 40px;
    }
    .check{
      background: orange;
    }
}
</style>


<div class="main_content">
    <div class="header">Write your Question?

        <div class="toggle_btn">
            <i class="fa-solid fa-bars " ></i>
        </div>
    
          <div class="dropdown_menu">
            <div class="text_dropdown"> 
            <li><a href="meprofile.html"  style="text-decoration:none"  ><i class="fas fa-home"></i>Home</a></li>
            <li ><a href="profileset.html" style="text-decoration:none"><i class="fas fa-user"></i>Profile</a></li>
            <li><a href="showpost.html" style="text-decoration:none"><i class="fas fa-address-card"></i>Post</a></li>
            <li><a href="learn.html" style="text-decoration:none"><i  class="fas fa-graduation-cap"></i>Learn</a></li>
            <li><a href="write.html" style="text-decoration:none"  class="check"><i class="fas fa-pen"></i>Write</a></li>
            <li><a href="showquizuser.html" style="text-decoration:none" ><i  class="fas fa-chalkboard-teacher"></i>Quiz</a></li>
            <li><a href="assistuser.html" style="text-decoration:none"  ><i  class="fas fa-chalkboard-teacher"></i>Assist</a></li>
            <li><a onclick="logout()" style="text-decoration:none"><i class='fas fa-sign-out-alt'></i>Logout</a></li>
        </div>
        </div>
    </div>

<div class="martop">


<div class="row row-cols-1 row-cols-md-3 g-4">
    <div class="col">
        <!-- <form method="POST" action="./saveimg.php" enctype="multipart/form-data"> -->
        <!-- <form method="POST" action="./saveimg.php" enctype="multipart/form-data"> -->
            <form  method="post" enctype="multipart/form-data" id="uploadFile">
        <div class="form-floating mb-3" class="inputemail">
            <input type="text" class="form-control" id="section2" name="section" class="inputemail">
            <label for="floatingInput">Write Section</label>
          </div>
  
  
          <div class="form-floating  mb-3">
          <textarea type="text" class="form-control w-100 " id="question2" name="question" class="inputpassword"></textarea>
          <label for="floatingPassword">Write your Question</label>
          </div>
  

                <input type="file" name="file"  id="files" multiple><br>
                <input type="submit"     onclick="getid(emailvalue,passvalue)" class="btn btn-primary w-100" class="buttonlogin" name="btn-post" value="insertpost" >
               
            <!-- </form> -->
           
        
        </form>
        <div id="result"></div>
 </div>

</div>
</div>


    </div>
    
</body>
</html>
<script>
    const toggle_btn =document.querySelector('.toggle_btn')
       const toggle_BtnIcon =document.querySelector('.toggle_btn i')
       const dropdownmenu =document.querySelector('.dropdown_menu')
       
       toggle_btn.onclick = function(){
           dropdownmenu.classList.toggle('open')
           const isOpen=dropdownmenu.classList.contains('open')
  
           toggle_BtnIcon.classList=isOpen
            ? 'fa-solid fa-xmark'
            : 'fa-solid fa-bars'
       }
  </script>
<script>
    const emailvalue=localStorage.getItem('email-send');
    const passvalue=localStorage.getItem('pass-send');
    console.log('this is write.html')
    console.log(emailvalue)
    console.log(passvalue)
    


    if(emailvalue==null && passvalue==null){
            window.location.href="./index.html";
        }
       else  if(emailvalue=='Admin69@gmail.com' && passvalue=='090165'){
            window.location.href="./index.html";
        }
       console.log(emailvalue)
        console.log(passvalue)
       function logout(){
        console.log('function logout');
        localStorage.removeItem('email-send')
        localStorage.removeItem('pass-send')
        window.location.href="./index.html";

       }



    function getid(email,pass){
   console.log("function getid");
   console.log(email);
   console.log(pass);

     const http= new XMLHttpRequest();
     http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/getid/"+email+"/"+pass);
     http.send();
     http.onreadystatechange=function(){
      if (http.readyState == 4 && http.status == "200") {

        let id1=JSON.parse(http.responseText);
        // for(let id2 of id1){
         let id2=id1[0];
          console.log("this is id object");
          console.log(id2["id_user"]);

                  datainsertpost(id2["id_user"]);

        //  insertpost(id2["id_user"]);
       
        // }
      
        
      }
     
      
        };
     
 }


 function datainsertpost(id2){

console.log("this is function datainsertpost");

 console.log('this is parameter id')
 console.log(id2)


 const section=document.getElementById('section2').value;
 const question=document.getElementById('question2').value;
 const img=document.getElementById('files').value;
 const namefilepost=img.split('\\').pop().split('/').pop();
 console.log('this is image file ')
 console.log(namefilepost)

            if(namefilepost!=""){
                const http= new XMLHttpRequest();
               //  http.open("GET","https://aggressive-tie-jay.cyclic.app/selectuser");
                 http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/insertpost/"+section+"/"+question+"/"+namefilepost+"/"+id2);
                 http.send();
                 window.location.href="meprofile.html"
            }
        else  if(namefilepost==""){
                const http= new XMLHttpRequest();
               //  http.open("GET","https://aggressive-tie-jay.cyclic.app/selectuser");
                 http.open("GET","https://good-cyan-reindeer-ring.cyclic.cloud/insertpostnoimg/"+section+"/"+question+"/"+id2);
                 http.send();
                 window.location.href="meprofile.html"
            }
         


                 // window.location.href="showpost.html"
             

               
                

                     // let  inserta= JSON.parse(this.responseText);
                     // let insertb=inserta["insertId"];
                    // console.log(this.responseText);
                    
                   //  console.log(insertb);
    //                for(const insertb of inserta){
    //                  console.log("this is id object insert");
    //                  console.log(inserta["insertId"]);
    //                  console.log(inserta); 
                    
                     
    //                  // iduser(id2["id_user"]);
    //                  // insertpost(id2["id_user"]);
    //                  //  insertpost(id2["id_user"]);
                 
    //    }
    
    // window.location.href="./meprofile.html"

}

$(document).on('submit','#uploadFile',function(e){
        e.preventDefault();
       var formData = new FormData(this);
        $.ajax({
        method:"POST",
        url: "saveimg2.php",
        data:formData,
        cache:false,
        contentType: false,
        processData: false,
         beforeSend:function(){
         $('button[type="submit"]').attr('disabled','disabled');
       },
        success: function(data){
       
        $('button[type="submit"]').removeAttr('disabled');
       
         $('#alertBox').html(data).fadeIn();
      }
           
});

      });   

</script>

